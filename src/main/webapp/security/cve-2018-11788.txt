CVS-2018-11788: XXE vulnerability found on Apache Karaf

Severity: Moderate

Vendor: The Apache Software Foundation

Versions Affected: all versions of Apache Karaf prior to 4.1.7, 4.2.2.

Description:

Apache Karaf provides a features deployer, which allows users to "hot deploy"
a features XML by dropping the file directly in the deploy folder.

The features XML is parsed by XMLInputFactory class.

Apache Karaf XMLInputFactory class doesn't contain any mitigation codes
against XXE.
This is a potential security risk as an user can inject external XML entities.

The mitigation is to prevent XXE by disabling external entities loading feature
in XMLInputFactory and XmlUtils.

This has been fixed in revision:

https://gitbox.apache.org/repos/asf?p=karaf.git;h=cc3332e
https://gitbox.apache.org/repos/asf?p=karaf.git;h=1ffa6d1

Mitigation: Apache Karaf users should upgrade to 4.1.7, 4.2.2
or later as soon as possible.

JIRA Tickets: https://issues.apache.org/jira/browse/KARAF-5911

Credit: This issue was reported by Brian Wang.
